---
- name: Set Casks Appdir Fact
  ansible.builtin.set_fact:
    casks_appdir: "{{ ansible_facts['user_dir'] }}/Applications"

- name: Install Taps
  include_tasks: taps.yaml

- name: Install Formulas
  include_tasks: brews.yaml

- name: Install Casks
  include_tasks: casks.yaml

- name: Start Services
  community.general.homebrew_services:
    state: present
    name: "{{ item }}" 
  loop: "{{ common_services + (additional_services | default([])) }}"

- name: Cleanup Unwanted Items
  include_tasks: cleanup.yaml
